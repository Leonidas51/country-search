{"version":3,"sources":["App.js","debounce.js","index.js"],"names":["limit_options","0","1","2","App","props","state","input_value","limit","loading","search_result","search_result_sliced","error","input_ref","React","createRef","onInputChange","bind","onSelectChange","fetchCountries","fn","delay","timer","args","onComplete","apply","clearTimeout","setTimeout","debounce","this","current","focus","query","setState","length","fetch","then","response","status","json","result","filter_result","filterResult","slice","list","filtered","toLowerCase","i","search_i","name","indexOf","unshift","push","e","new_val","target","value","className","map","key","id","type","ref","onChange","Component","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"0NAGA,IAAMA,EAAgB,CACpBC,EAAG,GACHC,EAAG,GACHC,EAAG,IAsJUC,E,kDAlJb,WAAYC,GAAQ,IAAD,8BACjB,cAAMA,IAEDC,MAAQ,CACXC,YAAa,GACbC,MAAO,GACPC,SAAS,EACTC,cAAe,GACfC,qBAAsB,GACtBC,MAAO,IAGT,EAAKC,UAAYC,IAAMC,YAEvB,EAAKC,cAAgB,EAAKA,cAAcC,KAAnB,gBACrB,EAAKC,eAAiB,EAAKA,eAAeD,KAApB,gBACtB,EAAKE,eC1BM,SAAkBC,EAAIC,GACnC,IAAIC,EAAQ,KACZ,OAAO,WAAmB,IAAC,IAAD,0BAANC,EAAM,yBAANA,EAAM,gBACxB,IAAMC,EAAa,WACjBJ,EAAGK,MAAM,EAAMF,GACfD,EAAQ,MAGPA,GACDI,aAAaJ,GAGfA,EAAQK,WAAWH,EAAYH,IDcTO,CAAS,EAAKT,eAAgB,KAhBnC,E,gEAoBjBU,KAAKhB,UAAUiB,QAAQC,U,qCAGVC,GAAQ,IAAD,OACpBH,KAAKI,SAAS,CACZrB,MAAO,KAGJoB,EAAME,OAUXC,MAAM,wCACHC,MAAK,SAAAC,GACoB,MAApBA,EAASC,OACXD,EAASE,OACNH,MAAK,SAAAI,GACJ,IAAMC,EAAgB,EAAKC,aAAaF,EAAQR,GAEhD,EAAKC,SAAS,CACZvB,cAAe+B,EACf9B,qBAAsB8B,EAAcE,MAAM,EAAG,EAAKrC,MAAME,OACxDC,SAAS,OAIf,EAAKwB,SAAS,CACZxB,SAAS,EACTG,MAAM,yJAAD,OAAmCyB,EAASC,aAzBvDT,KAAKI,SAAS,CACZvB,cAAe,GACfC,qBAAsB,GACtBF,SAAS,M,mCA4BFmC,EAAMZ,GACjB,IAAMa,EAAW,GAEjBb,EAAQA,EAAMc,cAEd,IAAK,IAAIC,EAAI,EAAGA,EAAIH,EAAKV,OAAQa,IAAK,CACpC,IACMC,EADqBJ,EAAKG,GAAGE,KAAKH,cACJI,QAAQlB,IAE1B,IAAdgB,IAEe,IAAbA,EACFH,EAASM,QAAQP,EAAKG,GAAGE,MAEzBJ,EAASO,KAAKR,EAAKG,GAAGE,OAK5B,OAAOJ,I,oCAGKQ,GACZ,IAAMC,EAAUD,EAAEE,OAAOC,MAEzB3B,KAAKI,SAAS,CACZ1B,YAAa+C,EACb7C,SAAS,IAGXoB,KAAKV,eAAemC,K,qCAGPD,GACbxB,KAAKI,SAAS,CACZzB,MAAOR,EAAcqD,EAAEE,OAAOC,OAC9B7C,qBAAsBkB,KAAKvB,MAAMI,cAAciC,MAAM,EAAG3C,EAAcqD,EAAEE,OAAOC,Y,+BAKjF,IAAI9C,EAgBJ,OAbEA,EADEmB,KAAKvB,MAAMM,MAEX,yBAAK6C,UAAU,gBAAgB5B,KAAKvB,MAAMM,OAG5BiB,KAAKvB,MAAMK,qBAAqB+C,KAAI,SAAAT,GAClD,OACE,yBAAKQ,UAAU,eAAeE,IAAKV,GAChCA,MAOP,yBAAKQ,UAAU,OACb,2BACEG,GAAG,aACHC,KAAK,OACLL,MAAO3B,KAAKvB,MAAMC,YAClBuD,IAAKjC,KAAKhB,UACVkD,SAAUlC,KAAKb,gBAEjB,yBAAKyC,UAAU,0BACb,0BAAMA,UAAU,qBAAhB,kEACA,4BAAQM,SAAUlC,KAAKX,gBACrB,4BAAQsC,MAAM,KAAd,MACA,4BAAQA,MAAM,KAAd,MACA,4BAAQA,MAAM,KAAd,QAGJ,yBAAKC,UAAU,iBAEX5B,KAAKvB,MAAMG,QACT,yBAAKgD,UAAU,YACf/C,Q,GA3III,IAAMkD,W,MEJxBC,IAASC,OACP,kBAAC,IAAMC,WAAP,KACE,kBAAC,EAAD,OAEFC,SAASC,eAAe,U","file":"static/js/main.a92d947a.chunk.js","sourcesContent":["import React from 'react';\nimport debounce from \"./debounce\";\n\nconst limit_options = {\n  0: 10,\n  1: 20,\n  2: 50\n}\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      input_value: \"\",\n      limit: 10,\n      loading: false,\n      search_result: [],\n      search_result_sliced: [],\n      error: \"\"\n    }\n\n    this.input_ref = React.createRef();\n\n    this.onInputChange = this.onInputChange.bind(this);\n    this.onSelectChange = this.onSelectChange.bind(this);\n    this.fetchCountries = debounce(this.fetchCountries, 500);\n  }\n\n  componentDidMount() {\n    this.input_ref.current.focus();\n  }\n\n  fetchCountries(query) {\n    this.setState({\n      error: \"\"\n    })\n\n    if (!query.length) {\n      this.setState({\n        search_result: [],\n        search_result_sliced: [],\n        loading: false\n      })\n\n      return;\n    }\n\n    fetch(\"https://restcountries.eu/rest/v2/all\")\n      .then(response => {\n        if (response.status === 200) {\n          response.json()\n            .then(result => {\n              const filter_result = this.filterResult(result, query);\n\n              this.setState({\n                search_result: filter_result,\n                search_result_sliced: filter_result.slice(0, this.state.limit),\n                loading: false\n              })\n            })\n        } else {\n          this.setState({\n            loading: false,\n            error: `Произошла ошибка! Код ответа: ${response.status}`\n          })\n        }\n      })\n  }\n\n  filterResult(list, query) {\n    const filtered = [];\n\n    query = query.toLowerCase();\n\n    for (let i = 0; i < list.length; i++) {\n      const country_name_lower = list[i].name.toLowerCase(),\n            search_i = country_name_lower.indexOf(query);\n      \n      if (search_i !== -1) {\n        // Если совпало начало слова - добавляем в начало выдачи\n        if (search_i === 0) {\n          filtered.unshift(list[i].name);\n        } else {\n          filtered.push(list[i].name);\n        }\n      }\n    }\n\n    return filtered;\n  }\n\n  onInputChange(e) {\n    const new_val = e.target.value;\n\n    this.setState({\n      input_value: new_val,\n      loading: true\n    })\n\n    this.fetchCountries(new_val);\n  }\n\n  onSelectChange(e) {\n    this.setState({\n      limit: limit_options[e.target.value],\n      search_result_sliced: this.state.search_result.slice(0, limit_options[e.target.value])\n    })\n  }\n\n  render() {\n    let search_result;\n\n    if (this.state.error) {\n      search_result = (\n        <div className=\"search_error\">{this.state.error}</div>\n      )\n    } else {\n      search_result = this.state.search_result_sliced.map(name => {\n        return (\n          <div className=\"country_name\" key={name}>\n            {name}\n          </div>\n        )\n      })\n    }\n\n    return (\n      <div className=\"App\">\n        <input\n          id=\"main-input\"\n          type=\"text\"\n          value={this.state.input_value}\n          ref={this.input_ref}\n          onChange={this.onInputChange}\n        />\n        <div className=\"limit-select-container\">\n          <span className=\"limit-select-text\">Показывать: </span>\n          <select onChange={this.onSelectChange}>\n            <option value=\"0\">10</option>\n            <option value=\"1\">20</option>\n            <option value=\"2\">50</option>\n          </select>\n        </div>\n        <div className=\"search-result\">\n          {\n            this.state.loading\n            ? <div className=\"spinner\" />\n            : search_result\n          }\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default App;\n","export default function debounce(fn, delay) {\r\n  let timer = null;\r\n  return function (...args) {\r\n    const onComplete = () => {\r\n      fn.apply(this, args);\r\n      timer = null;\r\n    }\r\n\r\n    if(timer) {\r\n      clearTimeout(timer);\r\n    }\r\n\r\n    timer = setTimeout(onComplete, delay);\r\n  }\r\n}","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport './style.css';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}